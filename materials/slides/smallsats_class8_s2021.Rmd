---
title: "Cloud-based Processing"
subtitle: "New Methods in Earth Observation"
date: "Class 6"
output:
  xaringan::moon_reader:
    lib_dir: libs
    css: ["default", "lucy", "middlebury-fonts", "themes/class6-theme.css"]
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---
class: center, middle
# Small Sats Review

---
### A look at our Planet results

```{r, eval = FALSE, echo = FALSE}
library(raster)
p <- dir("materials/data/06", pattern = "tif", full.names = TRUE)
rl <- lapply(p, function(x) {
  b <- brick(x)
  b / cellStats(b, max)
})

# plot
png("materials/slides/figures/06/planet_clips.png", width = 500, height = 150)
par(mfrow = c(1, 4), mar = c(0, 0, 1, 0), bg = "transparent")
for(i in 1:length(rl)) {
  b <- rl[[i]]
  nm <- gsub("_aoi.tif", "", basename(p[i]))
  plot(as(extent(b), "SpatialPolygons"), lty = 0, axes = FALSE)
  plotRGB(b[[1:3]], axes = FALSE, scale = 1, add = TRUE)
  mtext(nm, side = 3, line = 0, cex = 0.8, col = "white")
}
dev.off()
```

```{r, echo = FALSE, out.width="80%", fig.align='center'}
knitr::include_graphics('figures/06/planet_clips.png')
```

---

### GCVI => LAI

GCVI = (NIR / GRN) â€“ 1

GCVI = 1.4 * LAI^1.03 + 0.93

LAI = ((GCVI - 0.93) / 1.4)^(1 / 1.03)

```{r, eval = FALSE}
png("materials/slides/figures/06/planet_lai.png", width = 500, height = 150)
par(mfrow = c(1, 4), mar = c(0, 0, 1, 0))
for(i in 1:length(rl)) {
  b <- rl[[i]]
  gcvi <- b[[4]] / b[[1]] - 1
  lai <- ((gcvi - 0.93) / 1.4)^(1 / 1.03)
  nm <- gsub("_aoi.tif", "", basename(p[i]))
  plot(as(extent(lai), "SpatialPolygons"), lty = 0, axes = FALSE)
  plot(lai, axes = FALSE, add = TRUE, zlim = c(0, 5))#, 
       #axis.args = list(col = "white", col.axis = "white"))
  mtext(nm, side = 3, line = 0, cex = 0.8)#, col = "white")
}
dev.off()
```

---

```{r, echo = FALSE, out.width="80%", fig.align='center'}
knitr::include_graphics('figures/06/planet_lai.png')
```

---

# Take-aways from Small-Sats Module

&nbsp;&nbsp; - Understand what has enabled Small Sats

&nbsp;&nbsp; - Understand their value

&nbsp;&nbsp; - Understand their limitations

&nbsp;&nbsp; - Know how to access Planet data

&nbsp;&nbsp; - Run some basic searching & filtering

&nbsp;&nbsp; - Can do these things both programmatically and through Explorer


---

## Other work

&nbsp;&nbsp; - Loading a Planet Collection

&nbsp;&nbsp; - Harmonic models

&nbsp;&nbsp; - Smooth curves

&nbsp;&nbsp; - Center pivot detection

---

## Homework 

&nbsp;&nbsp; - Do the background readings for this unit

&nbsp;&nbsp; - Run & study code for harmonic models, smooth curves, & center pivot detection

&nbsp;&nbsp; - Load in the 2018 Whittier PlanetScope collection and clip to our extent

&nbsp;&nbsp; - Create a time series for the clipped PlanetScope collection

&nbsp;&nbsp; - Fit a smooth curves to the PlanetScope NDVI time series for 2018







